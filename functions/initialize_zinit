#! /usr/bin/env zsh

# -- # Ensures, installs, and inits Zinit ---------------------------------------------------------
local Z=${XDG_DATA_HOME:-$HOME/.local/share}/zinit/zinit.git/zinit.zsh
[[ -f $Z ]] || { mkdir -p $Z:h:h && git clone https://github.com/zdharma-continuum/zinit $Z:h:h:t }
source $Z

# -- enhances zinits abilites via ice-enhancing annexes  -------------------------------------------
zinit for id-as'gem-node'      @zdharma-continuum/zinit-annex-bin-gem-node                        \
          id-as'bin-symlink'   @zdharma-continuum/zinit-annex-binary-symlink                      \
          id-as'default-ice'   @zdharma-continuum/zinit-annex-default-ice                         \
          id-as'patch-dl'      @zdharma-continuum/zinit-annex-patch-dl                            \
          id-as'rust'          @zdharma-continuum/zinit-annex-rust

# ==================================================================================================
# -- modify global zshconfigs ----------------------------------------------------------------------   
# ==================================================================================================
local f=/etc/zshrc
sudo sed -i '/{,SAVE}HIST{FILE,SIZE,}=/d;$a\
HISTFILE=${${${(M)USER:#akuttor}:+}:-$HOME/.zsh_history}\
HISTSIZE=1000\
SAVEHIST=1000\
ZDOTDIR=${${(M)USER:#akuttor}:+$HOME/.dotfiles/configs/zsh}' $f

